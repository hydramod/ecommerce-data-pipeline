{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.10", "generated_at": "2025-09-13T03:07:08.738064Z", "invocation_id": "2b26aa5a-cfcf-4ed7-8d68-24323b177041", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-09-13T03:07:07.887385Z", "completed_at": "2025-09-13T03:07:07.902246Z"}, {"name": "execute", "started_at": "2025-09-13T03:07:07.902932Z", "completed_at": "2025-09-13T03:07:08.435154Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.5508925914764404, "adapter_response": {"_message": "MERGE (1 rows)", "rows_affected": 1, "query_id": "20250913_030711_00571_cg9g9", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.10\", \"profile_name\": \"ecom_analytics\", \"target_name\": \"dev\", \"node_id\": \"model.ecom_analytics.fct_sales_minute\"} */\n-- back compat for old kwarg name\n  \n  \n        \n            \n            \n        \n\n        \n\n        merge into \"delta\".\"gold\".\"fct_sales_minute\" as DBT_INTERNAL_DEST\n            using \"delta\".\"gold\".\"fct_sales_minute__dbt_tmp\" as DBT_INTERNAL_SOURCE\n            on (\n                DBT_INTERNAL_SOURCE.minute_bucket = DBT_INTERNAL_DEST.minute_bucket\n            )\n\n        \n        when matched then update set\n            \"minute_bucket\" = DBT_INTERNAL_SOURCE.\"minute_bucket\",\"gmv\" = DBT_INTERNAL_SOURCE.\"gmv\",\"paid_orders\" = DBT_INTERNAL_SOURCE.\"paid_orders\",\"processed_ts\" = DBT_INTERNAL_SOURCE.\"processed_ts\"\n        \n\n        when not matched then insert\n            (\"minute_bucket\", \"gmv\", \"paid_orders\", \"processed_ts\")\n        values\n            (DBT_INTERNAL_SOURCE.\"minute_bucket\", DBT_INTERNAL_SOURCE.\"gmv\", DBT_INTERNAL_SOURCE.\"paid_orders\", DBT_INTERNAL_SOURCE.\"processed_ts\")"}, "message": "MERGE (1 rows)", "failures": null, "unique_id": "model.ecom_analytics.fct_sales_minute", "compiled": true, "compiled_code": "-- models/gold/fct_sales_minute.sql\n\n\nwith orders as (\n  select\n    cast(order_id as bigint)  as order_id,\n    cast(total_amount as double) as total_amount,\n    event_ts\n  from \"delta\".\"silver\".\"orders_clean\"\n  where event_ts is not null\n),\nenriched as (\n  select\n    cast(order_id as bigint) as order_id,\n    fully_paid\n  from \"delta\".\"silver\".\"order_payments_enriched\"\n),\npaid_orders as (\n  select o.event_ts, o.total_amount\n  from orders o\n  join enriched e using (order_id)\n  where e.fully_paid = true\n)\n\nselect\n  date_trunc('minute', event_ts) as minute_bucket,\n  sum(total_amount)               as gmv,\n  count(*)                        as paid_orders,\n  current_timestamp               as processed_ts\nfrom paid_orders\n\nwhere event_ts >= (\n  select coalesce(max(minute_bucket) - interval '2' hour, timestamp '1970-01-01')\n  from \"delta\".\"gold\".\"fct_sales_minute\"\n)\n\ngroup by 1", "relation_name": "\"delta\".\"gold\".\"fct_sales_minute\"", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-09-13T03:07:08.463221Z", "completed_at": "2025-09-13T03:07:08.499633Z"}, {"name": "execute", "started_at": "2025-09-13T03:07:08.503246Z", "completed_at": "2025-09-13T03:07:08.638759Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.19898772239685059, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1, "query_id": "20250913_030711_00576_cg9g9", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.10\", \"profile_name\": \"ecom_analytics\", \"target_name\": \"dev\", \"node_id\": \"test.ecom_analytics.not_null_fct_sales_minute_minute_bucket.5efe674c96\"} */\n\n    select\n      count(*) as failures,\n      count(*) != 0 as should_warn,\n      count(*) != 0 as should_error\n    from (\n      \n    \n  \n    \n    \n\n\n\nselect minute_bucket\nfrom \"delta\".\"gold\".\"fct_sales_minute\"\nwhere minute_bucket is null\n\n\n\n  \n  \n      \n    ) dbt_internal_test"}, "message": null, "failures": 0, "unique_id": "test.ecom_analytics.not_null_fct_sales_minute_minute_bucket.5efe674c96", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect minute_bucket\nfrom \"delta\".\"gold\".\"fct_sales_minute\"\nwhere minute_bucket is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-09-13T03:07:08.451005Z", "completed_at": "2025-09-13T03:07:08.480661Z"}, {"name": "execute", "started_at": "2025-09-13T03:07:08.481371Z", "completed_at": "2025-09-13T03:07:08.641285Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.20224666595458984, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1, "query_id": "20250913_030711_00575_cg9g9", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.10\", \"profile_name\": \"ecom_analytics\", \"target_name\": \"dev\", \"node_id\": \"test.ecom_analytics.not_null_fct_sales_minute_gmv.3b614c0b2a\"} */\n\n    select\n      count(*) as failures,\n      count(*) != 0 as should_warn,\n      count(*) != 0 as should_error\n    from (\n      \n    \n  \n    \n    \n\n\n\nselect gmv\nfrom \"delta\".\"gold\".\"fct_sales_minute\"\nwhere gmv is null\n\n\n\n  \n  \n      \n    ) dbt_internal_test"}, "message": null, "failures": 0, "unique_id": "test.ecom_analytics.not_null_fct_sales_minute_gmv.3b614c0b2a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect gmv\nfrom \"delta\".\"gold\".\"fct_sales_minute\"\nwhere gmv is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-09-13T03:07:08.467540Z", "completed_at": "2025-09-13T03:07:08.506332Z"}, {"name": "execute", "started_at": "2025-09-13T03:07:08.507948Z", "completed_at": "2025-09-13T03:07:08.643902Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.20142412185668945, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1, "query_id": "20250913_030711_00574_cg9g9", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.10\", \"profile_name\": \"ecom_analytics\", \"target_name\": \"dev\", \"node_id\": \"test.ecom_analytics.not_null_fct_sales_minute_paid_orders.d4a64087ad\"} */\n\n    select\n      count(*) as failures,\n      count(*) != 0 as should_warn,\n      count(*) != 0 as should_error\n    from (\n      \n    \n  \n    \n    \n\n\n\nselect paid_orders\nfrom \"delta\".\"gold\".\"fct_sales_minute\"\nwhere paid_orders is null\n\n\n\n  \n  \n      \n    ) dbt_internal_test"}, "message": null, "failures": 0, "unique_id": "test.ecom_analytics.not_null_fct_sales_minute_paid_orders.d4a64087ad", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect paid_orders\nfrom \"delta\".\"gold\".\"fct_sales_minute\"\nwhere paid_orders is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-09-13T03:07:08.472848Z", "completed_at": "2025-09-13T03:07:08.486555Z"}, {"name": "execute", "started_at": "2025-09-13T03:07:08.492445Z", "completed_at": "2025-09-13T03:07:08.645549Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.20108580589294434, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1, "query_id": "20250913_030711_00573_cg9g9", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.10\", \"profile_name\": \"ecom_analytics\", \"target_name\": \"dev\", \"node_id\": \"test.ecom_analytics.not_null_fct_sales_minute_processed_ts.ac98267364\"} */\n\n    select\n      count(*) as failures,\n      count(*) != 0 as should_warn,\n      count(*) != 0 as should_error\n    from (\n      \n    \n  \n    \n    \n\n\n\nselect processed_ts\nfrom \"delta\".\"gold\".\"fct_sales_minute\"\nwhere processed_ts is null\n\n\n\n  \n  \n      \n    ) dbt_internal_test"}, "message": null, "failures": 0, "unique_id": "test.ecom_analytics.not_null_fct_sales_minute_processed_ts.ac98267364", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect processed_ts\nfrom \"delta\".\"gold\".\"fct_sales_minute\"\nwhere processed_ts is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2025-09-13T03:07:08.657103Z", "completed_at": "2025-09-13T03:07:08.669788Z"}, {"name": "execute", "started_at": "2025-09-13T03:07:08.670432Z", "completed_at": "2025-09-13T03:07:08.730378Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 0.07603907585144043, "adapter_response": {"_message": "SUCCESS", "rows_affected": -1, "query_id": "20250913_030712_00577_cg9g9", "query": "/* {\"app\": \"dbt\", \"dbt_version\": \"1.9.10\", \"profile_name\": \"ecom_analytics\", \"target_name\": \"dev\", \"node_id\": \"test.ecom_analytics.unique_fct_sales_minute_minute_bucket.8da9e94ee9\"} */\n\n    select\n      count(*) as failures,\n      count(*) != 0 as should_warn,\n      count(*) != 0 as should_error\n    from (\n      \n    \n  \n    \n    \n\nselect\n    minute_bucket as unique_field,\n    count(*) as n_records\n\nfrom \"delta\".\"gold\".\"fct_sales_minute\"\nwhere minute_bucket is not null\ngroup by minute_bucket\nhaving count(*) > 1\n\n\n\n  \n  \n      \n    ) dbt_internal_test"}, "message": null, "failures": 0, "unique_id": "test.ecom_analytics.unique_fct_sales_minute_minute_bucket.8da9e94ee9", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    minute_bucket as unique_field,\n    count(*) as n_records\n\nfrom \"delta\".\"gold\".\"fct_sales_minute\"\nwhere minute_bucket is not null\ngroup by minute_bucket\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 0.9943761825561523, "args": {"export_saved_queries": false, "skip_nodes_if_on_run_start_fails": false, "require_explicit_package_overrides_for_builtin_materializations": true, "log_file_max_bytes": 10485760, "vars": {}, "include_saved_query": false, "warn_error_options": {"include": [], "exclude": []}, "require_resource_names_without_spaces": false, "exclude_resource_types": [], "require_yaml_configuration_for_mf_time_spines": false, "log_format_file": "debug", "quiet": false, "partial_parse_file_diff": true, "project_dir": "/opt/dbt/ecom_analytics", "debug": true, "populate_cache": true, "send_anonymous_usage_stats": true, "target": "dev", "favor_state": false, "version_check": true, "indirect_selection": "eager", "state_modified_compare_more_unrendered_values": false, "use_colors": true, "printer_width": 80, "strict_mode": false, "partial_parse": true, "state_modified_compare_vars": false, "log_path": "/opt/dbt/ecom_analytics/logs", "macro_debugging": false, "empty": false, "show": false, "show_resource_report": false, "source_freshness_run_project_hooks": false, "select": ["fct_sales_minute"], "write_json": true, "defer": false, "exclude": [], "resource_types": [], "invocation_command": "dbt build --profiles-dir /opt/dbt --target dev --select fct_sales_minute --debug", "print": true, "profiles_dir": "/opt/dbt", "require_batched_execution_for_custom_microbatch_strategy": false, "log_level_file": "debug", "which": "build", "require_nested_cumulative_type_params": false, "cache_selected_only": false, "static_parser": true, "introspect": true, "log_format": "default", "use_colors_file": true, "log_level": "info"}}